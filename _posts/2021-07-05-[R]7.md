---
layout: single
title:  "[Must Learning with R_7] Ch9. ggplot2를 활용한 다양한 그래프 그리기"
category: 'Must Learning with R'
toc: true
toc_sticky: true
---


Wikidocs에 올라와있는 [Must Learning with R](https://wikidocs.net/book/4315) 을 참고하며 방학동안 부족한 R programming 공부를 하고있습니다.

# Ch9. ggplot2를 활용한 다양한 그래프 그리기

ggplot2로 그릴 수 있는 그래프들의 종류에 대해 알아보겠습니다.


```R
library(ggplot2)
library(dplyr)

STOCK = read.csv("D:\\uniqlo.csv")

STOCK$Date = as.Date(STOCK$Date)
STOCK$Year = as.factor(format(STOCK$Date,"%Y"))
STOCK$Day = as.factor(format(STOCK$Date,"%a"))


Group_Data = STOCK %>%
  group_by(Year, Day) %>%
  dplyr::summarise(Mean = round(mean(Open)),
                   Median = round(median(Open)),
                   Max = round(max(Open)),
                   Counts = length(Open)
                   )
```


<br/><br/>


## A1. Bar Chart(막대그래프)
막대도표는 가장 기본적인 그래프

### 하나의 이산형 변수를 기준으로 x축 변수 1개로만 그리는 경우

```R
ggplot(Group_Data) +
  geom_bar(aes(x = as.factor(Counts), fill = ..count.. )) +
  xlab("") + ylab("") +
  scale_fill_gradient(low = "#CCE5FF", high = "#FF00FF") +
  theme_classic() + ggtitle("Countinuous Color")
```

![Image Alt 텍스트](/assets/images/9_A1_1.jpeg)



<br/><br/>

```R
Group_Data %>%
  ggplot() +
  geom_bar(aes(x = as.factor(Counts), fill = Day), alpha = 0.3) +
  ylab("") + ylab("") +
  theme_classic() + ggtitle("Discrete Color")
```

![Image Alt 텍스트](/assets/images/9_A1_1'.jpeg)


<br/><br/>



### 색 구분 포지션을 변경하고 싶은 경우

```R
ggplot(Group_Data) +
  geom_bar(aes(x = as.factor(Counts), fill = ..count.. )) +
  xlab("") + ylab("") +
  scale_fill_gradient(low = "#CCE5FF", high = "#FF00FF") +
  theme_classic() + ggtitle("Countinuous Color")
```

![Image Alt 텍스트](/assets/images/9_A1_2.jpeg)



<br/><br/>


### x축, y축 1개씩 총 변수 2개로 그리는 경우, stat='identity'를 사용합니다.


```R
ggplot(Group_Data) +
  geom_bar(aes(x = Year, y=Mean, fill = Day), stat = 'identity') +
  scale_fill_manual(values = c("#C2DAEF","#C2EFDD","#BBAAE9",
                               "#E9F298","#FABDB3")) +
  theme_classic()
```

![Image Alt 텍스트](/assets/images/9_A1_3.jpeg)



<br/><br/>


## A2. Histogram (히스토그램)

연속형 변수를 시각화

```R
ggplot(STOCK) +
  geom_histogram(aes(x = High, fill = ..x..),
                 binwidth = 1000) + 
                 #binwidth : 히스토그램의 변수 구간을 조정
  scale_fill_gradient(low = "#CCE5FF", high = "#FF00FF") +
  theme_classic() + labs(fill = "Labels Name")
```


![Image Alt 텍스트](/assets/images/9_A2_1.jpeg)


<br/><br/>




```R
ggplot(STOCK) +
  geom_histogram(aes(x = High, fill =Day),
                 binwidth = 1000, alpha = 0.3) +
  theme_classic() + labs(fill = "Labels Name")
```

![Image Alt 텍스트](/assets/images/9_A2_1'.jpeg)

<br/><br/>

```R
ggplot(STOCK) +
  geom_histogram(aes(x = High, fill = Day),
                 binwidth = 1000, alpha = 0.3, position = "dodge") +
  theme_classic() + labs(fill = "Label Name")
```


![Image Alt 텍스트](/assets/images/9_A2_2.jpeg)


<br/><br/>




## A3. Densitiy plot

히스토그램과 비슷하게 작성. 그래프 면적이 각각의 비율이 되도록 맞춘다.

```R
ggplot(STOCK) +
  geom_density(aes(x = High)) +
  theme_classic() + labs(fill = "Labels Name")
```


![Image Alt 텍스트](/assets/images/9_A3_1.jpeg)


<br/><br/>

```R
ggplot(STOCK) +
  geom_density(aes(x = High, fill = Day) , alpha = 0.3) +
  theme_classic() + labs(fill = "Labels Name") +
  theme(axis.text.x = element_text(size = 9, angle =45,
                                   hjust = 1))
```


![Image Alt 텍스트](/assets/images/9_A3_2.jpeg)


<br/><br/>


## A4. Boxplot and Jitter plot
* 박스플롯은 데이터를 요약하는데 있어 매우 유용한 그래프. 상자의 밑변, 윗변은 각각 1, 3분위수를 의미. 상자를 감싸는 테두리는 울타리라고 하며 이 선을 벗어나면 이상치(Outlier)라 한다.
* 박스플롯을 그리기 위해서 x축은 descrete 변수를 ,y 축에는 continuous 변수를 배치

```R
ggplot(STOCK) +
  geom_boxplot(aes(x = Day, y= Volume, fill =Day),
               alpha = 0.3, outlier.color = 'red') +
  theme_bw()
```


![Image Alt 텍스트](/assets/images/9_A4_1.jpeg)


<br/><br/>

```R
ggplot(STOCK) +
  geom_boxplot(aes(x = Day, y = Volume, fill = Day),
               alpha = 0.2, outlier.color = 'red') +
  geom_jitter(aes(x = Day, y= Volume, col = Day), alpha = 0.1) +
  theme_bw()

```


![Image Alt 텍스트](/assets/images/9_A4_2.jpeg)


<br/><br/>



## A5. violin plot
박스플롯과 비슷한 역할을 수행

```R
ggplot(STOCK) +
  geom_violin(aes(x = Day, y= Volume, fill = Day),
              alpha = 0.3 ) +
  theme_bw()
```


![Image Alt 텍스트](/assets/images/9_A5_1.jpeg)


<br/><br/>


## A6. Scater plot
산점도는 데이터 상관관계를 파악하기에 유용한 그래프. 그래프에서 shape, size 등을 통해 다양한 그래프를 그릴 수 있음.

```R
ggplot(STOCK) +
  geom_point(aes(x = Open, y = Stock.Trading,
                 col = High, size = log(Volume), shape = Year)) +
  scale_color_gradient(low = "#CCE5FF", high =  "#FF00FF") +
  scale_shape_manual(values = c(19,20,21,22,23)) +
  labs(
    col = "Color", shape = "Shape", size = "Size"
  ) +
  theme_bw() +
  theme(axis.text.x = element_blank())
```


![Image Alt 텍스트](/assets/images/9_A6_1.jpeg)


<br/><br/>




## A7. Smooth plot
geom_smooth는 회귀선을 그려줌

```R
ggplot(STOCK) +
  geom_smooth(aes(x = Open, y = Stock.Trading),
              method = 'lm',
              col = '#8A8585') +
  theme_bw()
```


![Image Alt 텍스트](/assets/images/9_A7_1.jpeg)


<br/><br/>



```R
ggplot(STOCK) +
  geom_point(aes(x = Open, y = Stock.Trading, ),
             col = 'royalblue', alpha = 0.2) +
  geom_smooth(aes(x = Open, y = Stock.Trading),
              method = 'lm', col = '#8A8585') +
  theme_bw()
```


![Image Alt 텍스트](/assets/images/9_A7_2.jpeg)


<br/><br/>




## A8. bline, vline, hline
그래프에 평행선, 수직선, 대각선을 그릴 수 있는 명령어

```R
ggplot(NULL) +
  geom_vline(xintercept = 10, linetype = 'dashed',
             col = 'royalblue', size =3) +
  geom_hline(yintercept = 10, linetype = 'dashed',
             col = 'royalblue', size =3) +
  geom_abline(intercept = 0, slope =1, col ='red',
              size =3) +
  theme_bw()
```


![Image Alt 텍스트](/assets/images/9_A8_1.jpeg)


<br/><br/>


## A9. Step plot
계단형식의 그래프. 값의 증가량을 나타낼 때 효과적

```R
Hazard_Ratio = c(0.1,0.3,0.4,0.45,0.49,0.52,0.6,0.65,0.75,0.8,0.95)
Survival_Time = c(1,2,3,4,5,6,7,8,9,10,11)

ggplot(NULL) +
  geom_step(aes(x = Survival_Time , y = Hazard_Ratio), col = 'red') +
  scale_x_continuous(breaks = Survival_Time) +
  theme_classic()
```


![Image Alt 텍스트](/assets/images/9_A9_1.jpeg)


<br/><br/>
